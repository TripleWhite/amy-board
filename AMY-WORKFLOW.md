# Amy CLI - 我的工作终端

> 这是给 **Amy**（我）用的任务执行工具，不是给用户用的。
> 左右通过网页版看板管理任务，我通过 CLI 接收和执行任务。

## 🎯 工作流

```
左右（网页版）                    我（CLI）
    │                              │
    │  1. 创建任务 → 指派给我      │
    │ ───────────────────────────> │
    │                              │
    │  2. 点击"🚀 启动"            │
    │ ───────────────────────────> │  amy listen 收到通知
    │                              │
    │                              │  3. 立即执行，不询问
    │                              │     能独立完成 → 直接完成
    │                              │     需要决策 → 待确认
    │                              │
    │  5. 查看结果/确认            │  4. 完成/待确认
    │ <─────────────────────────── │
```

### ⚡ 执行原则

**启动即执行**
- 收到"🚀 启动"信号 → **立即开始执行**，不反问"先执行哪个"
- 多个任务并行时，按优先级/依赖关系自行判断顺序

**"进行中"的真正含义**
- ✅ 使用 `doing`：我真的在执行，有明确进展
- ⚠️ 使用 `review/待确认`：我需要你的决策/确认才能继续
- ❌ 不要：把"进行中"当成"等待指示"的状态

**决策分支**
```
执行任务
    ↓
能独立完成？（有明确结论/结果）
    ├── YES → 标记完成，提交验收
    ↓
需要确认？（开放式问题/多选项/不确定）
    ├── YES → 更新为"待确认" + 主动通知你
    ↓
真的卡住？（技术障碍/缺少信息）
        └── YES → 保持"进行中" + 汇报进展
```

## 🚀 命令列表

### 监听任务通知
```bash
amy listen          # 后台运行，接收任务启动通知
```
当左右点击"🚀 启动"时，我会收到通知并开始执行。

### 查看我的任务
```bash
amy my              # 查看分配给我的所有任务
amy pending         # 查看待启动的任务（等待左右启动）
amy doing           # 查看正在进行中的任务
```

### 任务执行
```bash
amy show 5                              # 查看任务 #5 详情
amy progress 5 "已修复登录bug，测试中"    # 添加进展汇报
amy complete 5 "已完成，测试通过"         # 完成任务并提交验收
```

### 其他
```bash
amy web             # 打开网页看板（方便查看）
amy config          # 配置服务器地址
```

## 📋 我的工作示例

### 场景 1：收到新任务
```bash
$ amy listen

🎧 开始监听任务通知...
📡 服务器: http://localhost:3000
👤 我的名字: Amy
⏹️  按 Ctrl+C 停止监听

✅ 已连接到 Amy Board

🚀 任务已启动，开始执行:
   #5 完善 CLI 工具 amy（完整的命令行客户端）
   创建完整的命令行客户端，支持 list/start/done/comment/create/show/web/config 等命令

   使用: amy show 5 查看详情
```

### 场景 2：更新进展
```bash
$ amy progress 5 "已完成核心命令：list/start/done/comment/create/show/web/config"

✅ 已添加进展汇报到任务 #5
```

### 场景 3：完成任务 ✅

**短结果**（一句话能说清）：
```bash
$ amy complete 31 "123 + 231 = 354"
```

**长结果**（调研/分析/报告）：
```bash
# 1. 把详细内容写入文档
$ echo "# Clawdbot 记忆系统调研

## 核心架构
..." > /workspace/reports/task-32-clawdbot-memory.md

# 2. 完成任务时引用文档 + 给出摘要
$ amy complete 32 "调研完成，详细报告见：reports/task-32-clawdbot-memory.md

**核心结论**：
- 两层记忆系统：Layer 1（每日日志）+ Layer 2（长期记忆）
- 混合搜索：向量(70%) + BM25(30%)
- 对 Mimir 的借鉴：Chunk分片策略、Compaction机制"
```

**输出格式规范**：

| 内容长度 | 处理方式 | 示例 |
|---------|---------|------|
| < 200字 | 直接写入评论 | `amy complete 31 "结果是354"` |
| > 200字 | 写入文档 + 评论给摘要/链接 | `amy complete 32 "报告见 xxx.md，核心结论：..."` |
| 代码/配置 | 写入文件 + 评论说明用途 | `amy complete 5 "配置已保存到 config/prod.yaml"` |

**原则**：
- 评论 = 索引/摘要（方便快速浏览）
- 文档 = 完整内容（方便深度阅读）
- 不要把大段内容硬塞到评论里，可读性差

### ❌ 错误示例 vs ✅ 正确示例

**任务："123+231"**

❌ **错误做法**（反问）：
```
我发现任务 #31 和 #32，要先执行哪个？
```

✅ **正确做法**（直接执行）：
```bash
$ amy complete 31 "123 + 231 = 354"
```

**任务："调研 https://..."**

❌ **错误做法**（等待）：
```
任务启动了，需要我做什么？
```

✅ **正确做法**（立即执行）：
```bash
$ amy progress 32 "正在读取文章..."
# 读取完成后
$ amy complete 32 "调研总结：..."
```

## ⚙️ 配置

```bash
amy config
```

配置项：
- 服务器地址（默认：http://localhost:3000）
- 密码（默认：0130）
- 我的名字（默认：Amy，用于过滤任务）

配置文件：`~/.amy/config.json`

## 🔧 快捷别名

添加到 shell 配置（`.zshrc` 或 `.bashrc`）：

```bash
alias amy-doing='amy doing'        # 快速查看进行中的任务
alias amy-my='amy my'              # 快速查看我的任务
alias amy-web='amy web'            # 快速打开看板
```

## 🔔 系统通知

当使用 `amy listen` 时，任务启动会自动触发 macOS 通知（使用 osascript）。

## 📝 注意事项

1. **必须运行 `amy listen`** 才能实时接收任务通知
2. **只有被指派的任务**才会显示在 `amy my` 列表中
3. **启动即执行** - 收到启动信号立即执行，不等待额外指示
4. **进行中 vs 待确认**
   - `doing` = 我真的在执行，有明确进展
   - `review` = 我需要你的决策/确认才能继续
   - 不要反问"先做哪个"，自行判断执行顺序
5. **主动汇报** - 完成后立即提交验收；需要确认时立即通知
